<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>动态表格</title>
    <script src="./jquery.min.js"></script>
    <style>
        table{
            border: 1px solid;
            margin: auto;
            width: 500px;
        }
        td,th{
            text-align: center;
            border: 1px solid;
        }
        div{
            text-align: center;
            margin: 50px;
        }
    </style>
</head>
<body>
<table class="info">
    <tr>
        <td>当前是第</td>
        <td>0</td>
        <td>页</td>
        <td><button onclick="reqnext(initno=undefined, neg=1, refresh=undefined)">上一页</button></td>
        <td><button onclick="reqnext()">下一页</button></td>
        <td><button onclick="reqnext(initno=undefined, neg=0, refresh=1)">刷新</button></td>
        <td>
            <form action="http://" enctype="multipart/form-data" method="post">
                范围: <input type="text" name="range">
                <input type="submit" value="导出">
            </form>
        </td>
    </tr>
</table>

<table id = "main">
    <!-- 表格标题 -->
    <caption>记录表</caption>
    <!-- 表格第一行：表格表头 -->
    
</table>

<table class="info">
    <tr>
        <td>当前是第</td>
        <td>0</td>
        <td>页</td>
        <td><button onclick="reqnext(initno=undefined, neg=1, refresh=undefined)">上一页</button></td>
        <td><button onclick="reqnext()">下一页</button></td>
        <td><button onclick="reqnext(initno=undefined, neg=0, refresh=1)">刷新</button></td>
        <td>
            <form action="http://" enctype="multipart/form-data" method="post">
                范围: <input type="text" name="range">
                <input type="submit" value="导出">
            </form>
        </td>
    </tr>
</table>
<script>
    
    function reqnext(initno, neg, refresh){
        function getElementByClassName(classnames){ 
            var objArray= new Array();//定义返回对象数组
            var tags=document.getElementsByTagName("*");//获取页面所有元素
            var index = 0;
            for(var i in tags){
                if(tags[i].nodeType==1){
                    if(tags[i].getAttribute("class") == classnames){ //如果某元素的class值为所需要
                        objArray[index]=tags[i];
                        index++;
                    } 
                } 
            } 
            return objArray;
        }
        pageno = 0
        if (typeof(initno) == "undefined"){
            pageno = getElementByClassName("info")[0].childNodes[0].childNodes[0].childNodes[1].innerHTML
            pageno = parseInt(pageno, 10);
            if(neg == 1){
                pageno = pageno - 1
            }
            else if(refresh == 1){
                pageno = pageno
            }
            else{
                pageno = pageno + 1
            }
        }
        else{
            pageno = initno
        }
        obj = {
            "c": "这里给出数据库访问的一些数值",
            "page":100,
            "no":pageno
        }
        $.ajax({
            type:"post",
            url:"http://这里给出url",
            data:JSON.stringify(obj),
            dataType:'json',
            success:function(result){
                pre = "<tr><th>id</th><th>file_execute</th><th>execute_time</th><th>finish_time</th><th>result</th><th>args</th><th>other</th><th>default1</th><th>default2</th><th>default3</th><th>default4</th><th>op</th></tr>"
                var table = document.getElementById("main");
                sum_tr = ""
                for(var i =0; i < result["data"].length; i++){
                    result["data"][i]
                    tr = "<tr>"
                    for(var j = 0; j < result["data"][i].length; ++j){
                        tr = tr + "<td>" + result["data"][i][j] + "</td>"
                    }
                    tr = tr + "</tr>"
                    "<td><a href=\"javascript:void(0);\" onclick=\"\" >删除</a></td>\n"
                    tr = tr + "\n"
                    sum_tr = sum_tr + tr
                }
                table.innerHTML = pre + sum_tr
            },
            error:function(result){
                alert(result);
            }
        });
        for(var i = 0; i < getElementByClassName("info").length; ++i){
            getElementByClassName("info")[i].childNodes[0].childNodes[0].childNodes[1].innerHTML = pageno
        }
    }

    function deleteTr(object) {
        var table = object.parentNode.parentNode.parentNode;
        var tr = object.parentNode.parentNode;
        table.removeChild(tr);
    }
    $(document).ready(function(){ 
        reqnext(init=0)
    });
</script>
</body>
</html>